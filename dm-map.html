<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Map Search</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- External CSS -->
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<h1>Map</h1>

<input id="q" placeholder="Search locationsâ€¦" autocomplete="off">
<ul id="results"></ul>

<script>
let pages = [];

// load index
fetch("search-index.json")
  .then(r => r.json())
  .then(data => pages = data);

const norm = s => (s || "").toLowerCase();

function search() {
  const q = norm(document.getElementById("q").value);
  const out = document.getElementById("results");
  out.innerHTML = "";
  if (!q) return;

  const matches = pages.filter(p =>
    norm(p.title).includes(q) ||
    norm(p.description || "").includes(q) ||
    (p.keywords || []).some(k => norm(k).includes(q))
  );

  if (matches.length === 0) {
    out.innerHTML = "<li class='no-results'>No results found.</li>";
    return;
  }

  matches.forEach(p => {
    out.innerHTML += `
      <li class="result ${p.style || ""}">
        ${p.icon ? `<img class="icon" src="${p.icon}" alt="">` : ""}
        <div class="card">
          <a href="${p.href}">${p.title}</a>
          <div class="meta">${p.description || ""}</div>
          ${p.rarity ? `<span class="badge ${p.rarity}">${p.rarity}</span>` : ""}
        </div>
      </li>
    `;
  });
}

document.getElementById("q").addEventListener("input", search);
</script>

</body>
</html>